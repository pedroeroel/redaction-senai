{% extends "layout.html" %}
{% set header = True %}
{% set footer = True %}
{% set main = True %}

{% block pagename %}Painel Admin{% endblock %}
{% block pagetext %}Painel Administrativo{% endblock %}

{% block content %}
<div class="space-y-12">

    <!-- DASHBOARD -->
    <section class="dashboard">
        <h2 class="text-3xl font-semibold text-[#f0eaff] mb-6">Dashboard</h2>

        <div class="grid md:grid-cols-3 gap-6">
            <div class="bg-[#4c2dbf] p-6 rounded-2xl shadow-xl text-center">
                <h3 class="text-lg text-[#e0d7ff] mb-2">Total de Usuários</h3>
                <p class="text-4xl font-bold">{% if user_count is defined %} {{user_count}} {% else %}N/A{% endif %}</p>
            </div>

            <div class="bg-[#4c2dbf] p-6 rounded-2xl shadow-xl text-center">
                <h3 class="text-lg text-[#e0d7ff] mb-2">Total de Redações Enviadas</h3>
                    <p class="text-4xl font-bold">{% if essay_count is defined%} {{essay_count}} {% else %}N/A{% endif %}</p>
            </div>

            <div class="bg-[#4c2dbf] p-6 rounded-2xl shadow-xl text-center">
                <h3 class="text-lg text-[#e0d7ff] mb-2">Média das Notas</h3>
                <p class="text-4xl font-bold">{% if essay_avg %} {{essay_avg}} {% else %}N/A{% endif %}</p>
            </div>
        </div>
    </section>

    <!-- USERS TABLE -->
    <section class="usuarios">
        <h2 class="text-3xl font-semibold text-[#f0eaff] mb-6">Usuários Cadastrados</h2>

        <div class="overflow-hidden rounded-xl shadow-xl">
                            <div class="grid gap-6 sm:grid-cols-1 md:grid-cols-2 lg:grid-cols-3">
                                {% for user in users %}
                                <div class="bg-[#3a1f7a] p-6 rounded-2xl shadow-xl flex flex-col justify-between">
                                    <div class="flex items-start gap-4">
                                        <div class="flex-shrink-0 rounded-full bg-[#4c2dbf] h-12 w-12 flex items-center justify-center">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-[#e0d7ff]" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
                                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                                <circle cx="12" cy="7" r="4"></circle>
                                            </svg>
                                        </div>

                                        <div class="flex-1">
                                            <div class="flex items-center justify-between">
                                                <div>
                                                    <div class="text-lg font-semibold text-[#e0d7ff]">
                                                        {% if user.username %} {{ user.username }} {% else %}N/A{% endif %}
                                                    </div>
                                                    <div class="text-sm text-[#cfc6ff] mt-1 whitespace-nowrap overflow-hidden text-ellipsis">
                                                        {% if user.email %} {{ user.email }} {% else %}N/A{% endif %}
                                                    </div>
                                                </div>

                                                <div class="text-right">
                                                    {% if user.admin %}
                                                        <div class="inline-flex items-center gap-2 text-green-400 font-semibold" title="Admin">
                                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                                <path d="M12 2l2 5 5 .5-3.8 3.2L17 18 12 15 7 18l1.8-7.3L5 7.5 10 7z"></path>
                                                            </svg>
                                                            <p class="md:hidden xl:inline-block">Admin</p>
                                                        </div>
                                                    {% else %}
                                                        <div class="inline-flex items-center gap-2 text-yellow-400 font-semibold" title="">
                                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
                                                                <circle cx="12" cy="7" r="4"></circle>
                                                            </svg>
                                                            <p class="md:hidden xl:inline-block">Usuário</p>
                                                        </div>
                                                    {% endif %}
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="mt-6 flex items-center justify-between gap-4">
                                        <div class="text-sm text-[#bfb3ff]">ID: {% if user.id %} {{ user.id }} {% else %}N/A{% endif %}</div>

                                        <div class="flex items-center gap-3">

                                            <a href="/admin/edit_user/{{ user.id }}" aria-label="Editar {{ user.username }}" title="Editar" class="text-yellow-400 hover:text-white">
                                                <!-- edit -->
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                    <path d="M12 20h9"></path>
                                                    <path d="M16.5 3.5a2.1 2.1 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
                                                </svg>
                                            </a>

                                            <a href="/admin/delete_user/{{ user.id }}" aria-label="Excluir {{ user.username }}" title="Excluir" class="text-red-500 hover:text-white">
                                                <!-- delete -->
                                                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                    <polyline points="3 6 5 6 21 6"></polyline>
                                                    <path d="M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"></path>
                                                    <path d="M10 11v6M14 11v6M9 6V4h6v2"></path>
                                                </svg>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
        </div>
    </section>

</div>
{% endblock %}
